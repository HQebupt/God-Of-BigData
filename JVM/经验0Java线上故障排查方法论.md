> 学什么？如果查Java的服务端程序问题

线上故障有哪些？主要会包括cpu、磁盘、内存以及网络问题，所以进行排查时候尽量四个方面依次排查一遍。

基本上出问题就是df、free、top 三连，然后依次jstack、jmap伺候，具体问题具体分析即可。

## 1 CPU

比较好定位，原因有哪些？

- 业务死循环
- 频繁GC
- 上下文切换过多

三连招：

- 看哪个进程占用比较高：`top`
- 这个进程的所有线程占用率排个序：`top -H -p pid`
- 转换10进制的线程id为16进制，jstack找出来看看
  - `printf '%x\n' 10进制id`
  - jstack grep一把`jstack -l pid| grep 'nid'--color -C5`：加上颜色，打印前后5行。

> 找到了线程，就要分析这个线程的状态是什么？重点关注什么
>
> - **wait on monitor entry：** 被阻塞的,肯定有问题。（这个没有例子）
>
> - **runnable** ： 注意有没有IO线程，常见于数据库死锁、外部依赖服务失效
>
> - **in Object.wait()**： 注意非线程池等待。